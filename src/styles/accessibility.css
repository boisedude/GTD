/**
 * Accessibility Support - Forced Colors & High Contrast Modes
 *
 * This file provides proper support for:
 * - Windows High Contrast Mode
 * - Browser forced colors mode
 * - Accessibility extensions
 * - System-level contrast preferences
 */

/* ===========================================
   FORCED COLORS MODE SUPPORT
   =========================================== */

@media (forced-colors: active) {
  /* Reset all custom colors to system colors */
  :root {
    /* Use system-defined colors that respect user preferences */
    --background: Canvas;
    --foreground: CanvasText;
    --card: Canvas;
    --card-foreground: CanvasText;
    --primary: LinkText;
    --primary-foreground: Canvas;
    --secondary: ButtonFace;
    --secondary-foreground: ButtonText;
    --muted: ButtonFace;
    --muted-foreground: GrayText;
    --accent: Highlight;
    --accent-foreground: HighlightText;
    --destructive: Canvas;
    --destructive-foreground: CanvasText;
    --border: ButtonText;
    --input: Canvas;
    --ring: Highlight;
  }

  /* Ensure all cards have proper contrast */
  .card,
  [class*="Card"] {
    background: Canvas !important;
    color: CanvasText !important;
    border: 1px solid ButtonText !important;
  }

  /* Form elements */
  input,
  textarea,
  select {
    background: Field !important;
    color: FieldText !important;
    border: 1px solid ButtonText !important;
  }

  input:focus,
  textarea:focus,
  select:focus {
    outline: 2px solid Highlight !important;
    outline-offset: 2px !important;
  }

  /* Buttons */
  button,
  [role="button"] {
    background: ButtonFace !important;
    color: ButtonText !important;
    border: 1px solid ButtonText !important;
  }

  button:hover,
  [role="button"]:hover {
    background: Highlight !important;
    color: HighlightText !important;
  }

  button:disabled,
  [role="button"]:disabled {
    background: GrayText !important;
    color: Canvas !important;
    opacity: 1 !important;
  }

  /* Links */
  a {
    color: LinkText !important;
  }

  a:visited {
    color: VisitedText !important;
  }

  a:hover,
  a:focus {
    color: HighlightText !important;
    background: Highlight !important;
  }

  /* Status indicators */
  [class*="bg-warning"],
  [class*="bg-error"],
  [class*="bg-success"],
  [class*="bg-info"] {
    background: Canvas !important;
    color: CanvasText !important;
    border: 2px solid ButtonText !important;
  }

  /* Remove background images and gradients */
  * {
    background-image: none !important;
    box-shadow: none !important;
    text-shadow: none !important;
  }

  /* Ensure icons are visible */
  svg,
  img {
    filter: none !important;
    opacity: 1 !important;
  }

  /* Force borders on important elements */
  .border-0,
  .border-none {
    border: 1px solid ButtonText !important;
  }
}

/* ===========================================
   HIGH CONTRAST PREFERENCE SUPPORT
   =========================================== */

@media (prefers-contrast: high) {
  :root {
    /* Increase contrast ratios */
    --brand-gray-50: 255 255 255;
    --brand-gray-100: 248 250 252;
    --brand-gray-900: 0 0 0;
    --brand-navy: 0 0 0;
    --brand-navy-dark: 0 0 0;
  }

  /* Ensure text has maximum contrast */
  body {
    background: white !important;
    color: black !important;
  }

  /* High contrast cards */
  .card,
  [class*="Card"] {
    background: white !important;
    color: black !important;
    border: 2px solid black !important;
  }

  /* High contrast form elements */
  input,
  textarea,
  select {
    background: white !important;
    color: black !important;
    border: 2px solid black !important;
  }

  /* High contrast buttons */
  button,
  [role="button"] {
    background: white !important;
    color: black !important;
    border: 2px solid black !important;
    font-weight: bold !important;
  }

  button:hover,
  [role="button"]:hover {
    background: black !important;
    color: white !important;
  }

  /* High contrast links */
  a {
    color: blue !important;
    text-decoration: underline !important;
  }

  a:visited {
    color: purple !important;
  }

  /* High contrast status indicators - removed global bg-warning rule */
  /* Task highlighting is now handled by TaskHighlightProvider context */

  [class*="bg-error"] {
    background: rgb(var(--color-error)) !important;
    color: white !important;
    border: 2px solid black !important;
  }

  [class*="bg-success"] {
    background: rgb(var(--color-success)) !important;
    color: white !important;
    border: 2px solid black !important;
  }

  [class*="bg-info"] {
    background: rgb(var(--color-info)) !important;
    color: white !important;
    border: 2px solid black !important;
  }
}

/* ===========================================
   REDUCED MOTION SUPPORT
   =========================================== */

@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }

  /* Disable auto-playing animations */
  [class*="animate-"],
  [class*="transition-"] {
    animation: none !important;
    transition: none !important;
  }
}

/* ===========================================
   SCREEN READER IMPROVEMENTS
   =========================================== */

/* Screen reader only content */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

/* Skip navigation link */
.skip-nav {
  position: absolute;
  top: -40px;
  left: 6px;
  z-index: 1000;
  padding: 8px 16px;
  background: white;
  color: black;
  text-decoration: none;
  border: 2px solid black;
  border-radius: 4px;
}

.skip-nav:focus {
  top: 6px;
}

/* Focus indicators that work in all modes */
*:focus-visible {
  outline: 2px solid currentColor !important;
  outline-offset: 2px !important;
}

@media (forced-colors: active) {
  *:focus-visible {
    outline: 2px solid Highlight !important;
    outline-offset: 2px !important;
  }
}

/* ===========================================
   UTILITY CLASSES FOR ACCESSIBILITY
   =========================================== */

/* Force readable text combinations */
.a11y-high-contrast {
  background: white !important;
  color: black !important;
  border: 1px solid black !important;
}

.a11y-warning {
  background: rgb(var(--color-warning-light) / 0.1) !important;
  color: rgb(var(--color-warning-dark)) !important;
  border: 1px solid rgb(var(--color-warning)) !important;
}

.a11y-error {
  background: rgb(var(--color-error-light) / 0.1) !important;
  color: rgb(var(--color-error-dark)) !important;
  border: 1px solid rgb(var(--color-error)) !important;
}

.a11y-success {
  background: rgb(var(--color-success-light) / 0.1) !important;
  color: rgb(var(--color-success-dark)) !important;
  border: 1px solid rgb(var(--color-success)) !important;
}

/* Ensure these work in forced colors mode too */
@media (forced-colors: active) {
  .a11y-high-contrast,
  .a11y-warning,
  .a11y-error,
  .a11y-success {
    background: Canvas !important;
    color: CanvasText !important;
    border: 2px solid ButtonText !important;
  }
}
